<!DOCTYPE html>
<html lang="id" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TrendLens - Pelacak Tren Microstock</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1/plugin/weekday.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1/plugin/weekOfYear.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }
        .active-nav {
            background-color: #2563eb;
            color: white;
        }
        .calendar-day:hover {
            transform: scale(1.05);
            background-color: #374151;
        }
        .premium-feature::after {
            content: 'PREMIUM';
            position: absolute;
            top: 4px;
            right: 4px;
            background-color: #fbbf24;
            color: #422006;
            padding: 2px 6px;
            font-size: 8px;
            border-radius: 4px;
            font-weight: bold;
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-200">
    <div class="flex h-screen">
        <!-- Sidebar Navigation -->
        <aside class="w-64 bg-gray-800/50 backdrop-blur-sm border-r border-gray-700/50 p-4 flex flex-col">
            <h1 class="text-2xl font-bold text-white mb-8">
                Trend<span class="text-blue-500">Lens</span>
            </h1>
            <nav class="flex flex-col space-y-2">
                <a href="#" id="nav-dashboard" class="nav-link active-nav flex items-center px-4 py-2 rounded-lg">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 mr-3"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
                    Dasbor
                </a>
                <a href="#" id="nav-explore" class="nav-link flex items-center px-4 py-2 rounded-lg hover:bg-gray-700">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 mr-3"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
                    Jelajahi Tren
                </a>
                <a href="#" id="nav-calendar" class="nav-link flex items-center px-4 py-2 rounded-lg hover:bg-gray-700">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 mr-3"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg>
                    Kalender Musiman
                </a>
                <a href="#" id="nav-notifications" class="nav-link flex items-center px-4 py-2 rounded-lg hover:bg-gray-700 relative">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 mr-3"><path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"/><path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"/></svg>
                    Notifikasi
                    <span class="absolute top-2 right-2 w-2 h-2 bg-red-500 rounded-full"></span>
                </a>
            </nav>
            <div class="mt-auto">
                <div class="bg-blue-900/50 border border-blue-700 rounded-lg p-4 text-center">
                    <h3 class="font-bold text-white">Buka Semua Fitur</h3>
                    <p class="text-sm text-blue-200 mt-1 mb-3">Dapatkan akses tak terbatas ke tren, riwayat, dan notifikasi.</p>
                    <button id="upgrade-btn" class="w-full bg-blue-600 hover:bg-blue-500 text-white font-bold py-2 px-4 rounded-lg transition-colors">Upgrade Sekarang</button>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 p-6 overflow-y-auto">
            <!-- Dashboard View -->
            <div id="view-dashboard" class="view">
                <h2 class="text-3xl font-bold text-white mb-6">Dasbor</h2>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="lg:col-span-2 bg-gray-800/70 p-6 rounded-xl shadow-lg">
                        <h3 class="text-xl font-semibold mb-4 text-white">üåü Kata Kunci Emas (Permintaan Tinggi, Kompetisi Rendah)</h3>
                        <div id="golden-keywords-container" class="space-y-3"></div>
                    </div>
                    <div class="bg-gray-800/70 p-6 rounded-xl shadow-lg">
                        <h3 class="text-xl font-semibold mb-4 text-white">üóìÔ∏è Acara Mendatang</h3>
                        <div id="upcoming-events-container" class="space-y-3"></div>
                    </div>
                </div>
            </div>

            <!-- Other Views (Explore, Calendar, Notifications) can be added here -->
            <!-- ... -->

        </main>
    </div>
    
    <!-- Modals can be added here -->
    <!-- ... -->

<script>
document.addEventListener('DOMContentLoaded', function () {
    // --- KONFIGURASI PENTING ---
    // URL backend Anda dari Replit sudah dimasukkan di sini.
    const API_BASE_URL = "https://f1f3dbec-8c50-41ac-8410-c574d88eefaa-00-3dy8y7n6agmqb.pike.replit.dev";

    // --- DOM ELEMENTS ---
    const goldenKeywordsContainer = document.getElementById('golden-keywords-container');
    const upcomingEventsContainer = document.getElementById('upcoming-events-container');
    // ... (DOM elements lainnya tetap sama)

    // --- UTILITY FUNCTIONS ---
    const showLoader = (container) => {
        container.innerHTML = `<div class="flex justify-center items-center p-8"><div class="loader"></div></div>`;
    };

    const showError = (container, message) => {
        container.innerHTML = `<div class="text-center p-8 text-red-400 font-semibold">${message}</div>`;
    };

    const getScoreColor = (score, type = 'demand') => {
        if (type === 'demand') {
            if (score >= 75) return 'text-green-400';
            if (score >= 50) return 'text-yellow-400';
            return 'text-red-400';
        } else { // competition
            // Semakin rendah semakin baik
            if (score <= 500000) return 'text-green-400';
            if (score <= 2000000) return 'text-yellow-400';
            return 'text-red-400';
        }
    };

    const createKeywordElement = (item) => {
        const element = document.createElement('div');
        element.className = 'bg-gray-700/50 p-4 rounded-lg flex items-center justify-between hover:bg-gray-700 transition-colors cursor-pointer';
        element.dataset.keywordId = item.id;
        element.innerHTML = `
            <div>
                <p class="font-semibold text-white">${item.keyword}</p>
            </div>
            <div class="flex items-center space-x-4 text-right">
                <div>
                    <p class="text-xs text-gray-400">Permintaan</p>
                    <p class="font-bold ${getScoreColor(item.demand_score, 'demand')}">${item.demand_score}</p>
                </div>
                <div>
                    <p class="text-xs text-gray-400">Kompetisi</p>
                    <p class="font-bold ${getScoreColor(item.competition_count, 'competition')}">${(item.competition_count / 1000000).toFixed(1)} Jt</p>
                </div>
            </div>
        `;
        // element.addEventListener('click', () => openKeywordModal(item.id)); // Logika modal bisa diaktifkan kembali nanti
        return element;
    };

    // --- DATA FETCHING ---
    async function fetchGoldenKeywords() {
        // Cek jika URL belum diubah oleh pengguna
        if (API_BASE_URL === "PASTE_YOUR_RENDER_URL_HERE") {
            showError(goldenKeywordsContainer, "Konfigurasi Diperlukan: Harap masukkan URL API backend Anda di dalam kode JavaScript.");
            return;
        }

        showLoader(goldenKeywordsContainer);
        try {
            const response = await fetch(`${API_BASE_URL}/api/v1/trends/analyze`);
            if (!response.ok) {
                throw new Error(`Error HTTP! status: ${response.status}`);
            }
            const data = await response.json();
            
            goldenKeywordsContainer.innerHTML = ''; // Hapus loader
            if (data && data.length > 0) {
                data.forEach(item => {
                    goldenKeywordsContainer.appendChild(createKeywordElement(item));
                });
            } else {
                showError(goldenKeywordsContainer, "Tidak ada kata kunci emas yang ditemukan saat ini.");
            }
        } catch (error) {
            console.error("Gagal mengambil data golden keywords:", error);
            showError(goldenKeywordsContainer, "Tidak dapat memuat data tren. Pastikan URL API benar dan server backend sedang berjalan.");
        }
    }

    // --- STATIC DATA (untuk fitur yang belum terhubung ke backend) ---
    const mockEvents = [
        { date: "2025-10-31", name: "Halloween", keywords: ["spooky", "pumpkin", "costume party"] },
        { date: "2025-11-28", name: "Black Friday", keywords: ["sale", "shopping", "discount"] },
        { date: "2025-12-25", name: "Natal", keywords: ["pohon natal", "musim dingin", "liburan"] }
    ];

    const renderUpcomingEvents = () => {
        upcomingEventsContainer.innerHTML = '';
        const upcomingEvents = mockEvents
            .filter(e => dayjs(e.date).isAfter(dayjs()))
            .slice(0, 3);
        upcomingEvents.forEach(event => {
            const eventEl = document.createElement('div');
            eventEl.className = 'bg-gray-700/50 p-3 rounded-lg flex items-center';
            eventEl.innerHTML = `
                <div class="text-center mr-4 bg-blue-500/20 p-2 rounded-md">
                    <p class="text-xs text-blue-300">${dayjs(event.date).format('MMM')}</p>
                    <p class="font-bold text-lg text-white">${dayjs(event.date).format('DD')}</p>
                </div>
                <div>
                    <p class="font-semibold text-white">${event.name}</p>
                    <p class="text-xs text-gray-400">${event.keywords.slice(0,2).join(', ')}...</p>
                </div>`;
            upcomingEventsContainer.appendChild(eventEl);
        });
    };

    // --- INITIALIZATION ---
    function initializeApp() {
        // Ambil data asli untuk dasbor
        fetchGoldenKeywords();
        
        // Tampilkan bagian lain dari data tiruan untuk sementara
        renderUpcomingEvents();
        // renderExplore(); // Bisa dihubungkan nanti
        // renderCalendar();
        // renderNotifications();
        
        // Atur navigasi
        // ... (Logika navigasi tetap sama)
    }

    initializeApp();
});
</script>
</body>
</html>
